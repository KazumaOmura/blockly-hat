<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Blockly - Hat</title>
  <link rel="stylesheet" media="all" href="./style.css">
  <script src='https://cdn.jsdelivr.net/npm/store-js@2.0.4/dist/store.legacy.min.js'></script>
  <!-- <script src="hat.js"></script> -->
  <!-- <script src="bundle.js"></script> -->
</head>

<body>
  <!-- <input type="text" value="sample1.sch" disabled /> -->
	<!-- <input id="input_hoge" type="button" value="Run" onclick="runCode_hat()"/><br>
	<textarea id="text_hoge" class="lined" cols="40" rows="6" spellcheck="false"></textarea> -->

  <div id="blockly">
    <h2>main定義エリア</h2>
  <div id="blocklyDiv"></div>
  <h2>関数定義エリア</h2>
  <div id="blocklyDiv_function"></div>
  <xml id="toolbox_main" style="display: none">
    <category name="標準" colour="0">
      <block type="string"></block>
      <block type="num"></block>
      <block type="num_statement"></block>
      <block type="num2"></block>
      <block type="num2_statement"></block>
      <block type="print"></block>
      <block type="logic_compare"></block>  
      <block type="operator"></block>  
    </category>

    <category name="リスト" colour="15">
      <block type="createlist"></block>

      <block type="add_headlist_node">
        <value name="node">
          <block type="list_element"></block>
        </value>
      </block>

      <block type="get_list_headnode"></block>
      <block type="get_list_Second_and_subsequent"></block>
      <block type="list_null_check"></block>
      <block type="list_print"></block>
      <block type="list_variable"></block>
    </category>

    <category name="配列" colour="25">
      <block type="arrangement">
        <value name="element">
          <block type="arrangement_element"></block>
        </value>
      </block>
      <block type="arrangement_element"></block>
      <block type="arrangement_element_print"></block>
      <block type="arrangement_name"></block>
    </category>

    <category name="配列変数" colour="35" custom="arrangement_VARIABLE">
    </category>

    <category name="繰り返し" colour="150">
      <block type="repeat"></block>
      <block type="roop_if_break"></block>
    </category>

    <category name="計算" colour="100">
      <block type="calc"></block>
      <block type="add"></block>
      <block type="num2_statement"></block>
    </category>

    <category name="分岐" colour="150">
      <block type="controls_if"></block>
      <block type="controls_if3"></block>
      <block type="controls_if_else"></block>
      <block type="controls_if2"></block>
    </category>

    <category name="変数" colour="300" custom="VARIABLE"></category>

    <!-- <category name="関数定義" colour="330" custom="NUMBER_VARIABLE"></category> -->
    <!-- <category name="関数定義" colour="330">
      <block type="variables_set_number"></block>
      <block type="variables_get_number"></block>
      <block type="variables_get_number2"></block>
    </category> -->


    <category name="関数呼び出し" colour="250">
      <block type="call_def_func2">
        <value name="call">
          <block type="call_func_andarg2">
            <value name="arg">
              <block type="arg">
                <value name="arg_elem">
                  <block type="num">
                  </block>
                </value>
              </block>
            </value>
            <value name="arg">
              <block type="arg">
                <value name="arg_elem">
                  <block type="num">
                  </block>
                </value>
              </block>
            </value>
          </block>
        </value>
        <value name="return">
          <block type="num2">
          </block>
        </value>
      </block>
      <block type="num2"></block>
      <block type="arg"></block>
      <block type="sample_arg2"></block>
      <block type="return"></block>
      <block type="list_variable"></block>
    </category>

    <category name="その他" colour="350">
      <block type="text"></block>
    </category>
  </xml>
  <xml id="toolbox_function" style="display: none">
    <category name="標準" colour="0">
      <block type="string"></block>
      <block type="num"></block>
      <block type="num2"></block>
      <block type="num_statement"></block>
      <block type="print"></block>
      <block type="logic_compare"></block>  
      <block type="operator"></block> 
    </category>

    <category name="分岐" colour="150">
      <block type="if_else"></block>
      <block type="controls_if3"></block>
      <block type="controls_if2"></block>
    </category>

    <category name="リスト" colour="15">
      <block type="add_headlist_node">
        <value name="node">
          <block type="list_element"></block>
        </value>
      </block>

      <block type="get_list_headnode"></block>
      <block type="get_list_Second_and_subsequent"></block>
      <block type="list_null_check"></block>
      <block type="list_print"></block>
      <block type="list_variable"></block>
    </category>

    <category name="計算" colour="100">
      <block type="calc"></block>
      <block type="add"></block>
      <block type="num2_statement"></block>
    </category>

    <category name="組み立て済み" colour="50">
      <!-- reduce ここから -->
      <block type="def_func">
        <value name="define">
          <block type="call_def_func">
            <value name="call">
              <block type="call_func_andarg">
                <value name="arg">
                  <block type="arg">
                    <value name="arg_elem">
                      <block type="num">
                      </block>
                    </value>
                  </block>
                </value>
                <value name="arg">
                  <block type="arg">
                    <value name="arg_elem">
                      <block type="num">
                      </block>
                    </value>
                  </block>
                </value>
              </block>
            </value>
            <value name="return">
              <block type="num2">
              </block>
            </value>
          </block>
        </value>
        <value name="do">
          <block type="if_else">
            <value name="if_conditions">
              <block type="list_null_check"></block>
            </value>
            <value name="if">
              <block type="return"></block>
            </value>
            <value name="else">
              <block type="get_list_headnode"></block>
            </value>
          </block>
        </value>
      </block>
      <!-- reduce ここまで -->
      <block type="call_def_func2">
        <value name="call">
          <block type="call_func_andarg2">
            <value name="arg">
              <block type="arg">
                <value name="arg_elem">
                  <block type="num">
                  </block>
                </value>
              </block>
            </value>
            <value name="arg">
              <block type="arg">
                <value name="arg_elem">
                  <block type="num">
                  </block>
                </value>
              </block>
            </value>
          </block>
        </value>
        <value name="return">
          <block type="num2">
          </block>
        </value>
      </block>
    </category>

    <category name="関数定義" colour="200">
      <!-- <block type="call_func"></block>
      <block type="Recursive_call"></block> -->
      <!-- <block type="Recursive_func"></block>
      <block type="variables_set_number"></block> -->
      <block type="def_func"></block>
      <block type="call_def_func"></block>
      <block type="call_func_andarg"></block>
      <block type="arg"></block>
      <block type="num2"></block>
      <block type="return"></block>
    </category>

    <category name="関数呼び出し" colour="250">
      <block type="call_def_func2">
        <value name="call">
          <block type="call_func_andarg2">
            <value name="arg">
              <block type="arg">
                <value name="arg_elem">
                  <block type="num">
                  </block>
                </value>
              </block>
            </value>
            <value name="arg">
              <block type="arg">
                <value name="arg_elem">
                  <block type="num">
                  </block>
                </value>
              </block>
            </value>
          </block>
        </value>
        <value name="return">
          <block type="num2">
          </block>
        </value>
      </block>
      <block type="num2"></block>
      <block type="arg"></block>
      <block type="sample_arg2"></block>
      <block type="return"></block>
      <block type="list_variable"></block>
    </category>

    <category name="変数" colour="300" custom="VARIABLE"></category>
  </xml>
  </div>

  <div id="code_area">
    <!-- <div class="js_area">
      <h2>JavaScript</h2>
      <pre id='jsCode'>

      </pre>
    </div> -->
    <div class="hat_area">
      <h2>Hatコード</h2>
      <textarea class="outputcode" id="HatCode"></textarea>
    </div>
    <div class="hat_output_area">
      <h2>Hat出力エリア</h2>
      <textarea style="font-size:24px;" class="outputcode" id="terminal"></textarea>
    </div>
  </div>

  <div id="btn_area">
    <button id="showCode">ソースコードを表示する</button>
    <button id="runCode">コードを実行する</button>
  </div>

</body>

</html>

<!-- ライブラリ -->
<script src="lib/js-interpreter/acorn_interpreter.js"></script>
<script src="lib/google-blockly/blockly_compressed.js"></script>
<script src="lib/google-blockly/blocks_compressed.js"></script>
<script src="lib/google-blockly/javascript_compressed.js"></script>
<script src="lib/google-blockly/hat_compressed.js"></script>
<script src="lib/google-blockly/msg/js/ja.js"></script>
<script src="custom_block.js"></script>

<!-- 出力と実行 -->
<script src="taterm.js"></script>
<script src="index.js"></script>
<script src="sexpr-plus.js"></script>
<script src="hat.js"></script>

<!-- 作成したブロック定義ファイル -->
<script src="block_def/standard_category.js"></script>
<script src="block_def/list_category.js"></script>
<script src="block_def/arrangement_category.js"></script>
<script src="block_def/roop_category.js"></script>
<script src="block_def/calc_category.js"></script>
<script src="block_def/if_category.js"></script>
<script src="block_def/function_def_category.js"></script>
<script src="block_def/function_call_category.js"></script>
<script src="block_def/trash.js"></script>

<!-- カテゴリーカスタムファイル -->
<!-- <script src="CategoryCallback/workspace.js"></script> -->

<!-- <script type="text/javascript">
  // function runCode(button){
  function runCode_hat(){
    let text_hoge = document.getElementById("text_hoge").value;
    console.log(text_hoge);
    HatInterpreter.startCode("Run", text_hoge, "main");
  }
</script> -->